![example workflow](https://github.com/malykhdenis/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)

# YaMDb
## Описание

**YaMDb** собирает отзывы пользователей на различные произведения. 
- Произведения делятся на категории: «Книги», «Фильмы», «Музыка».
- Произведению может быть присвоен жанр из списка предустановленных.
- Пользователи могут оставить к произведениям текстовые отзывы и поставить 
произведению оценку в диапазоне от одного до десяти, из пользовательских 
оценок формируется усреднённая оценка произведения — рейтинг. На одно 
произведение пользователь может оставить только один отзыв.

## Роли и права пользователей
В проекте **YaMDb** реализована ролевая модель управления доступами.
Доступные роли и права пользователей:
- **Аноним** — может просматривать описания произведений, читать отзывы и 
комментарии.
- **Аутентифицированный пользователь (user)** — может читать всё, как и Аноним, 
может публиковать отзывы и ставить оценки произведениям 
(фильмам/книгам/песенкам), может комментировать отзывы; может редактировать и 
удалять свои отзывы и комментарии, редактировать свои оценки произведений. Эта 
роль присваивается по умолчанию каждому новому пользователю.
- **Модератор (moderator)** — те же права, что и у Аутентифицированного 
пользователя, плюс право удалять и редактировать любые отзывы и комментарии.
- **Администратор (admin)** — полные права на управление всем контентом 
проекта. Может создавать и удалять произведения, категории и жанры. 
Может назначать роли пользователям.
- **Суперюзер Django** обладает правами администратора, пользователя 
с правами admin.

## Установка

Устанавливаем Docker:

- **Windows 10: Корпоративная и Pro.**  
Для Корпоративной и Pro-версий Windows виртуализация настраивается на основе гипервизора Hyper-V.
Включите его, перейдите в Панель управления — Программы и компоненты — Включение и отключение компонентов Windows.
Далее активируйте пункт Hyper-V. Чтобы изменения вступили в силу, перезагрузите систему.
- **Windows 10 Home**  
Для корректной работы Docker в Windows 10 Home установите подсистему Linux (WSL2) по инструкции с официального сайта Microsoft.
- **Windows 7**  
Для настройки системы виртуализации в Windows 7 скачайте и установите специальную программу для работы с виртуальными машинами, например, VMWare или VirtualBox; скачайте образ Ubuntu; установите Docker по инструкции для Linux (она ниже).
- **Windows 10/11 и MacOS**  
Зайдите на официальный сайт проекта и скачайте установочный файл Docker Desktop для вашей операционной системы.
Запустите его и следуйте инструкциям по установке. Для Windows программа предложит установить необходимые компоненты для WSL2. Поставьте галочку, если будете использовать эту систему виртуализации.
- **Linux**  
Выполнить команды в терминале:
  
  ```
  # Установка утилиты для скачивания файлов
  sudo apt install curl
  # Эта команда скачает скрипт для установки докера
  curl -fsSL https://get.docker.com -o get-docker.sh
  # Эта команда запустит его
  sh get-docker.sh
  ```

Клонируем репозиторий:
```
git clone https://github.com/malykhdenis/infra_sp2
```

Переходим в папку с файлом docker-compose.yaml:
```
cd infra_sp2/infra
```

Запускаем docker-compose:
```
docker-compose up -d --build 
```

Создаем миграции:
```
docker-compose exec web python manage.py makemigrations
```

Выполняем миграции:
```
docker-compose exec web python manage.py migrate
```

Создаем суперпользователя:
```
docker-compose exec web python manage.py createsuperuser
```

Собираем статику:
```
docker-compose exec web python manage.py collectstatic --no-input 
```

Для заполнения базы данных, заходим в браузере по адресу:
```
http://localhost/admin/ 
```

## API и примеры его использования

В проекте **YaMDb** предусмотрен **API**. 
Ниже доступны некоторые примеры его использвания.

Регистрация новых пользователей:
```
POST /api/v1/auth/signup/

{
    "email": "string",
    "username": "string"
}
```

Получить список всех категорий:
```
GET /api/v1/categories/

[
  {
    "count": 0,
    "next": "string",
    "previous": "string",
    "results": [
      {
        "name": "string",
        "slug": "string"
      }
    ]
  }
]
```

Произведения, к которым пишут отзывы:
```
GET /api/v1/titles/

[
  {
    "count": 0,
    "next": "string",
    "previous": "string",
    "results": [
      {
        "id": 0,
        "name": "string",
        "year": 0,
        "rating": 0,
        "description": "string",
        "genre": [
          {
            "name": "string",
            "slug": "string"
          }
        ],
        "category": {
          "name": "string",
          "slug": "string"
        }
      }
    ]
  }
]
```

Добавить новый отзыв:
```
POST /api/v1/titles/{title_id}/reviews/

{
  "text": "string",
  "score": 1
}
```

## шаблон наполнения env-файла

```
DB_ENGINE=django.db.backends.postgresql # указываем, что работаем с postgresql
DB_NAME=postgres # имя базы данных
POSTGRES_USER=user # логин для подключения к базе данных
POSTGRES_PASSWORD=user # пароль для подключения к БД (установите свой)
DB_HOST=db # название сервиса (контейнера)
DB_PORT=5432 # порт для подключения к БД
```

## используемые технологии
Краткий список:
- Django 2.2.16
- PyJWT 2.1.0
- djoser 2.1.0
- djangorestframework 3.12.4

Полный список доступен в **requirements.txt**